From bd887a2af1a6163d7cd1ae0cb27890c249c31c46 Mon Sep 17 00:00:00 2001
From: Alfred Chen <cchalpha@gmail.com>
Date: Fri, 29 Dec 2023 11:06:33 +0000
Subject: [PATCH] sched/alt: [Sync] 8639ecebc9b1 workqueue: Implement
 non-strict affinity scope for unbound workqueues

---
 kernel/workqueue.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/kernel/workqueue.c b/kernel/workqueue.c
index e4dbcbe149f3..5c56ed92d344 100644
--- a/kernel/workqueue.c
+++ b/kernel/workqueue.c
@@ -1114,6 +1114,7 @@ static bool kick_pool(struct worker_pool *pool)
 
 	p = worker->task;
 
+#ifndef CONFIG_SCHED_ALT
 #ifdef CONFIG_SMP
 	/*
 	 * Idle @worker is about to execute @work and waking up provides an
@@ -1139,6 +1140,8 @@ static bool kick_pool(struct worker_pool *pool)
 		get_work_pwq(work)->stats[PWQ_STAT_REPATRIATED]++;
 	}
 #endif
+#endif /* !CONFIG_SCHED_ALT */
+
 	wake_up_process(p);
 	return true;
 }
-- 
GitLab

